@model IEnumerable<CommunityEvents.Models.Review>

@{
	ViewData["Title"] = "Manage Reviews";
}

<div class="d-flex justify-content-between align-items-center mb-3">
	<h2>Moderation Queue</h2>
	<a asp-action="Index" class="btn btn-secondary">Back to dashboard</a>
</div>

@if (TempData["SuccessMessage"] != null)
{
	<div class="alert alert-success">@TempData["SuccessMessage"]</div>
}

@if (!Model.Any())
{
	<div class="alert alert-info">No reviews found in the system.</div>
}
else
{
	<table class="table table-striped table-hover align-middle">
		<thead class="table-dark">
			<tr>
				<th>Author</th>
				<th>Event</th>
				<th>Rating</th>
				<th>Comment</th>
				<th>Actions</th>
			</tr>
		</thead>
		<tbody>
			@foreach(var item in Model)
			{
				<tr>
					<td>
						<strong>@(item.User?.UserName ?? "Unknown")</strong><br />
					</td>
					<td>
						<a asp-controller="Events" asp-action="Details" asp-route-id="@item.EventId">
							@(item.Event?.Title ?? "Unknown Event")
						</a>
					</td>
					<td>
						<span class="text-warning">@item.Rating ★</span>
					</td>
					<td class="text-break" style="max-width: 300px;">
						@item.Content
					</td>
					<td>
						<form asp-action="DeleteReview" asp-route-id="@item.ReviewId" method="post" onsubmit="return confirm('Are you sure you want to delete this review?');">
							<button type="submit" class="btn btn-danger btn-sm">Delete</button>
						</form>
					</td>
				</tr>
			}
		</tbody>
	</table>
}